# -*- coding: utf-8 -*-
"""Untitled40.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1UGvGz0CqCZ5z7e_-my4d0vkYx-byPi7k
"""

import pandas as pd
import sqlite3

conn = sqlite3.connect("cybersec.db")
cursor = conn.cursor()

cursor.execute("""
CREATE TABLE IF NOT EXISTS users(
    user_id INTEGER PRIMARY KEY,
    username TEXT,
    role TEXT
);
""")

cursor.execute("""
CREATE TABLE IF NOT EXISTS login_logs(
    login_id INTEGER PRIMARY KEY,
    user_id INTEGER,
    login_time TEXT,
    ip_address TEXT,
    FOREIGN KEY (user_id) REFERENCES users(user_id)
);
""")

cursor.execute("""
CREATE TABLE IF NOT EXISTS alerts(
    alert_id INTEGER PRIMARY KEY,
    user_id INTEGER,
    alert_type TEXT,
    severity TEXT,
    FOREIGN KEY (user_id) REFERENCES users(user_id)
);
""")

cursor.execute("INSERT INTO users VALUES (1,'Alice','Analyst')")
cursor.execute("INSERT INTO users VALUES (2,'Bob','Admin')")
cursor.execute("INSERT INTO users VALUES (3,'Charlie','Engineer')")

cursor.execute("INSERT INTO login_logs VALUES (1,1,'2025-01-01 10:00','192.168.1.10')")
cursor.execute("INSERT INTO login_logs VALUES (2,2,'2025-01-01 11:30','192.168.1.11')")

cursor.execute("INSERT INTO alerts VALUES (1,1,'Phishing Attempt','High')")
cursor.execute("INSERT INTO alerts VALUES (2,3,'Malware Detected','Critical')")

conn.commit()

INNER JOIN (Users with Login Logs)
query = """
SELECT u.user_id, u.username, l.login_time, l.ip_address
FROM users u
INNER JOIN login_logs l
ON u.user_id = l.user_id;
"""

pd.read_sql_query(query, conn)

LEFT JOIN (Users with Alerts)
query = """
SELECT u.username, a.alert_type, a.severity
FROM users u
LEFT JOIN alerts a
ON u.user_id = a.user_id;
"""

pd.read_sql_query(query, conn)

RIGHT JOIN
query = """
SELECT a.alert_type, a.severity, u.username
FROM alerts a
LEFT JOIN users u
ON a.user_id = u.user_id;
"""

pd.read_sql_query(query, conn)

FULL OUTER JOIN
query = """
SELECT u.username, l.login_time
FROM users u
LEFT JOIN login_logs l ON u.user_id = l.user_id
UNION
SELECT u.username, l.login_time
FROM login_logs l
LEFT JOIN users u ON u.user_id = l.user_id;
"""

pd.read_sql_query(query, conn)

Multi-table JOIN (Users + Logins + Alerts)
query = """
SELECT u.username, l.login_time, a.alert_type, a.severity
FROM users u
LEFT JOIN login_logs l ON u.user_id = l.user_id
LEFT JOIN alerts a ON u.user_id = a.user_id;
"""

pd.read_sql_query(query, conn)